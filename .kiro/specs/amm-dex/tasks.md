# AMM DEX 実装タスクリスト

## プロジェクトセットアップとコア構造

- [ ] 1. モノレポプロジェクト構造の初期化

  - pnpm ワークスペース設定とルート package.json 作成
  - pkgs/contract、pkgs/frontend ディレクトリ構造作成
  - 基本的な.gitignore と README.md ファイル作成
  - フォーマッターとリンターを設定(Biome)
  - _要件: 1.1, 7.1_

- [ ] 2. スマートコントラクト開発環境のセットアップ

  - Hardhat 設定ファイル（hardhat.config.ts）の実装
  - 必要な依存関係のインストール（Hardhat、OpenZeppelin、viem 等）
  - solhint 設定ファイル（.solhint.json、.solhintignore）の作成
  - prittier(スマートコントラクトのみ)
  - TypeScript 設定とディレクトリ構造の作成
  - _要件: 8.1, 8.2_

- [ ] 3. フロントエンド開発環境のセットアップ
  - Next.js（App Router）プロジェクトの初期化
  - 必要な依存関係のインストール（wagmi、viem、ethers、RainbowKit 等）
  - Shadcn/UI 設定（components.json）と Tailwind CSS 設定
  - PWA 設定（next.config.js）とディレクトリ構造の作成
  - _要件: 7.1, 7.2_

## スマートコントラクト実装

- [ ] 4. 基本コントラクトインターフェースの実装

  - IDEXFactory、IDEXPair、IDEXRouter インターフェースの定義
  - ITestTokenFaucet インターフェースの定義
  - 基本的なエラー定義とイベント定義
  - _要件: 2.1, 3.1, 8.1_

- [ ] 5. DEXFactory コントラクトの実装

  - ペア作成機能（createPair）の実装
  - ペア管理機能（getPair、allPairs）の実装
  - 手数料管理機能（feeTo、feeToSetter）の実装
  - OpenZeppelin の Ownable を使用したアクセス制御
  - _要件: 3.1, 8.1, 8.2_

- [ ] 6. DEXPair コントラクトの実装

  - ERC-20 LP トークン機能の実装
  - 流動性管理機能（mint、burn）の実装
  - スワップ機能（swap）と x\*y=k 公式の実装
  - 価格オラクル機能とリザーブ管理
  - _要件: 2.1, 3.1, 8.1, 9.1_

- [ ] 7. DEXRouter コントラクトの実装

  - 流動性追加機能（addLiquidity）の実装
  - 流動性除去機能（removeLiquidity）の実装
  - トークンスワップ機能（swapExactTokensForTokens）の実装
  - デッドライン保護とスリッページ制御の実装
  - _要件: 2.1, 2.2, 3.1, 8.1_

- [ ] 8. TestTokenFaucet コントラクトの実装

  - トークン配布機能（requestTokens）の実装
  - 日次制限とクールダウン機能の実装
  - 管理者機能（setTokenLimit）の実装
  - セキュリティ機能（リエントランシー対策）の実装
  - _要件: 8.1, 8.2_

- [ ] 9. 検証用 ERC-20 トークンの実装
  - TestTokenA と TestTokenB コントラクトの作成
  - 基本的な ERC-20 機能と mint 機能の実装
  - Faucet コントラクトとの連携機能
  - _要件: 2.1, 3.1_

## スマートコントラクトテストとデプロイ

- [ ] 10. DEXFactory コントラクトのテスト実装

  - ペア作成機能の正常系・異常系テスト
  - アクセス制御機能のテスト
  - イベント発火の検証テスト
  - ガス使用量の最適化テスト
  - _要件: 8.1, 9.1_

- [ ] 11. DEXPair コントラクトのテスト実装

  - 流動性追加・除去の正常系・異常系テスト
  - スワップ機能の数学的正確性テスト
  - 価格オラクル機能のテスト
  - リエントランシー攻撃対策のテスト
  - _要件: 2.1, 8.1, 8.2_

- [ ] 12. DEXRouter コントラクトのテスト実装

  - 全機能の正常系・異常系テスト
  - デッドライン保護機能のテスト
  - スリッページ制御機能のテスト
  - マルチホップスワップのテスト
  - _要件: 2.1, 2.2, 8.1_

- [ ] 13. TestTokenFaucet コントラクトのテスト実装

  - トークン配布機能のテスト
  - 制限機能（日次制限、クールダウン）のテスト
  - セキュリティ機能のテスト
  - _要件: 8.1, 8.2_

- [ ] 14. デプロイヘルパー関数の実装

  - contractsJsonHelper.ts の実装
  - デプロイ結果の保存・読み込み機能
  - 環境別設定管理機能
  - _要件: 8.1_

- [ ] 15. Ignition デプロイスクリプトの実装

  - 各コントラクトのデプロイスクリプト作成
  - デプロイ順序の管理とエラーハンドリング
  - 初期設定とペア作成の自動化
  - Sepolia テストネットへのデプロイ検証
  - _要件: 8.1, 8.2_

- [ ] 16. Hardhat タスクの実装
  - 各コントラクトの主要機能をタスク化
  - デプロイ後の動作確認用タスク作成
  - 管理者機能の実行タスク作成
  - _要件: 8.1_

## フロントエンド基盤実装

- [ ] 17. Web3 プロバイダーとウォレット接続の実装

  - wagmi 設定と RainbowKit 統合
  - Alchemy RPC プロバイダー設定
  - ウォレット接続・切断機能の実装
  - ネットワーク切り替え機能の実装
  - _要件: 1.1, 1.2, 1.3, 1.4_

- [ ] 18. コントラクトインターフェースとフックの実装

  - スマートコントラクトの ABI 統合
  - カスタムフック（useContract、useTokenBalance 等）の実装
  - トランザクション管理フックの実装
  - エラーハンドリング機能の実装
  - _要件: 1.1, 7.4, 8.1_

- [ ] 19. 基本 UI コンポーネントの実装

  - Shadcn/UI ベースコンポーネントのセットアップ
  - レイアウトコンポーネント（Header、Footer、Sidebar）の実装
  - 共通 UI コンポーネント（Button、Input、Card 等）のカスタマイズ
  - レスポンシブデザインの実装
  - _要件: 7.1, 7.2_

- [ ] 20. ルーティングとページ構造の実装
  - Next.js Page Router ベースのページ作成
  - \_app.tsx、\_document.tsx の実装
  - 基本的なページレイアウトとナビゲーション
  - PWA 設定とマニフェストファイル
  - _要件: 7.1, 7.2_

## コア機能実装

- [ ] 21. トークンスワップ機能の実装

  - スワップページ（swap.tsx）の実装
  - トークン選択コンポーネントの実装
  - 数量入力とリアルタイム見積もり機能
  - スリッページ設定とトランザクション実行
  - _要件: 2.1, 2.2, 2.3, 2.4, 2.5_

- [ ] 22. 流動性提供機能の実装

  - 流動性管理ページ（pool.tsx）の実装
  - 流動性追加フォームの実装
  - 価格比率計算と表示機能
  - LP トークン管理機能
  - _要件: 3.1, 3.2, 3.3, 3.4, 3.5_

- [ ] 23. 流動性プール表示機能の実装

  - プール一覧表示コンポーネント
  - プール詳細情報（TVL、APR、取引量）の表示
  - プール統計とチャート機能
  - ユーザーポジション表示機能
  - _要件: 4.1, 4.2, 4.3, 4.4_

- [ ] 24. Faucet 機能の実装

  - Faucet ページ（faucet.tsx）の実装
  - トークン請求フォームの実装
  - 制限時間とクールダウン表示
  - トランザクション状態管理
  - _要件: 検証用機能_

- [ ] 25. 価格表示・チャート機能の実装

  - リアルタイム価格表示コンポーネント
  - 価格チャート（時間軸選択機能付き）の実装
  - 価格変動率の計算と表示
  - 取引量データの表示
  - _要件: 5.1, 5.2, 5.3, 5.4_

- [ ] 26. トランザクション履歴機能の実装

  - 履歴ページ（history.tsx）の実装
  - 取引履歴の取得と表示機能
  - フィルタリング機能（日付、タイプ、トークン）
  - CSV エクスポート機能
  - _要件: 6.1, 6.2, 6.3, 6.4, 6.5_

- [ ] 27. ポートフォリオ機能の実装
  - ポートフォリオページ（portfolio.tsx）の実装
  - 資産残高とポジション表示
  - 損益計算と表示機能
  - パフォーマンス統計の表示
  - _要件: 4.4, 6.1_

## 統合とテスト

- [ ] 28. フロントエンドコンポーネントテストの実装

  - 主要コンポーネントの単体テスト
  - Web3 フックのテスト
  - UI/UX テストの実装
  - アクセシビリティテストの実装
  - _要件: 7.4, 9.1_

- [ ] 29. E2E テストの実装

  - ウォレット接続からスワップまでのフルフロー
  - 流動性提供・除去のフルフロー
  - エラーハンドリングのテスト
  - PWA 機能のテスト
  - _要件: 7.4, 8.1, 9.1_

- [ ] 30. パフォーマンス最適化とセキュリティ強化
  - コンポーネントの最適化（React.memo 等）
  - バンドルサイズの最適化
  - セキュリティ監査とペネトレーションテスト
  - ガス使用量の最適化確認
  - _要件: 8.1, 8.2, 9.1, 9.2_

## 最終統合とデプロイ

- [ ] 31. 本番環境デプロイの準備

  - 環境変数の設定と管理
  - CI/CD パイプラインの構築
  - セキュリティ設定の最終確認
  - パフォーマンス監視の設定
  - _要件: 8.1, 8.2, 9.1_

- [ ] 32. ドキュメント作成と最終テスト
  - ユーザーマニュアルの作成
  - 開発者向けドキュメントの作成
  - 最終的な統合テストの実行
  - セキュリティ監査レポートの作成
  - _要件: 7.4, 8.1, 8.2_
